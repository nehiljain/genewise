library(roxygen2)
library(devtools)
devtools::document()
dir_rbind
dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = T,col_names = c("chr","pos","allele","p_value"),out_file_path = "/Users/nehiljain/code/personal/genewiseR/")
dir_rbind("/Users/nehiljain/code/personal/genewiseR/data",header = T,col_names = c("chr","pos","allele","p_value"),out_file_path = "/Users/nehiljain/code/personal/genewiseR/")
getwd()
devtools::use_testthat()
devtools::test()
devtools::test()
dir_rbind("/Users/nehiljain/code/personal/genewiseR/data",header = T)
devtools::install_local("~/code/personal/genewiseR/")
dir_rbind("/Users/nehiljain/code/personal/genewiseR/data",header = T)
dir_rbind("/Users/nehiljain/code/personal/genewiseR/data",header = T, col_names = c("A","B","C","D"))
print(names(head_data))
dir_rbind("/Users/nehiljain/code/personal/genewiseR/data",header = F, col_names = c("A","B","C","D"))
devtools::install_local("~/code/personal/genewiseR/")
dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = T,col_names = c("chr","pos","allele","p_value"),out_file_path = "/Users/nehiljain/code/personal/genewiseR/")
dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = F,col_names = c("chr","pos","allele","p_value"),out_file_path = "/Users/nehiljain/code/personal/genewiseR/")
dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = F,col_names = c("chr","pos","allele","p_value"))
dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = F,col_names = c("chr","pos","allele","p_value"),out_file_path = "/Users/nehiljain/code/personal/genewiseR/data/combined_indel_gwas_result.tsv")
dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = F,col_names = c("chr","pos","allele","p_value"),out_file_path = "/Users/nehiljain/code/personal/genewiseR/data/combined_indel_gwas_result.tsv")
devtools::install_local("~/code/personal/genewiseR/")
dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = F,col_names = c("chr","pos","allele","p_value"),out_file_path = "/Users/nehiljain/code/personal/genewiseR/data/combined_indel_gwas_result.tsv")
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = F,col_names = c("chr","pos","allele","p_value"))
devtools::test()
devtools::document()
savehistory(file = ".genewsieRPubRhistory")
savehistory(file = ".genewsieRPubRhistory")
library(data.table)
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = F,col_names = c("chr","pos","allele","p_value"))
library(devtools)
devtools::install_local("~/code/personal/genewiseR/")
library(genewiseR)
ref_df <- read_tsv("~/code/personal/genewiseR_data/ref/indels.Bos_taurus.vcf", comment())
library(readr)
ref_df <- read_tsv("~/code/personal/genewiseR_data/ref/indels.Bos_taurus.vcf", comment = "##", progress = T, trim_ws = T)
source('~/code/personal/genewiseR/R/get-snp-ids.r')
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = F,col_names = c("chr","pos","allele","p_value"))
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = F,col_names = c("chr","pos","allele","p_value"))
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR_data/raw_data/",header = F,col_names = c("chr","pos","allele","p_value"))
View(combine_gwas_df)
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR_data/raw_data/",header = F,col_names = c("chr_no","snp_pos","allele","p_value"))
result_df <- get_snp_ids(combine_gwas_df, ref_df = )
result_df <- get_snp_ids(combine_gwas_df, ref_df )
library(assertthat)
result_df <- get_snp_ids(combine_gwas_df, ref_df )
library(data.table)
sessionInfo()
session_info()
library(data.table)
install.packages(data.table)
install.packages("data.table")
library(data.table)
data.table::merge()
devtools::session_info()
merge.data.table
devtools::document()
warnings*)
warnings())
warnings()
savehistory(file = "~/code/personal/genewiseR/.genewiseR_history")
source('~/code/personal/genewiseR/R/get-snp-ids.r')
ref_df <- read_tsv("~/code/personal/genewiseR_data/ref/indels.Bos_taurus.vcf", comment = "##", progress = T, trim_ws = T)
library(readr)
ref_df <- read_tsv("~/code/personal/genewiseR_data/ref/indels.Bos_taurus.vcf", comment = "##", progress = T, trim_ws = T)
library(devtools)
devtools::install_local("~/code/personal/genewiseR/")
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = F,col_names = c("chr","pos","allele","p_value"))
library(genewiseR)
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = F,col_names = c("chr","pos","allele","p_value"))
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR_data/raw_data/",header = F,col_names = c("chr","pos","allele","p_value"))
result_df <- get_snp_ids(combine_gwas_df, ref_df )
library(assertthat)
result_df <- get_snp_ids(combine_gwas_df, ref_df )
source('~/code/personal/genewiseR/R/get-snp-ids.r')
source('~/code/personal/genewiseR/R/get-snp-ids.r')
result_df <- get_snp_ids(combine_gwas_df, ref_df )
source('~/code/personal/genewiseR/R/get-snp-ids.r')
source('~/code/personal/genewiseR/R/get-snp-ids.r')
result_df <- get_snp_ids(combine_gwas_df, ref_df )
ref_df <- read_tsv("~/code/personal/genewiseR_data/ref/indels.Bos_taurus.vcf", comment = "##", progress = T, trim_ws = T)
View(ref_df)
read_csv("x,y\n1,2\n3,4", col_types = "dc")
ref_df <- read_tsv("~/code/personal/genewiseR_data/ref/indels.Bos_taurus.vcf", comment = "##", progress = T, trim_ws = T, col_types = "cicccnc")
ref_df <- read_tsv("~/code/personal/genewiseR_data/ref/indels.Bos_taurus.vcf", comment = "##", progress = T, trim_ws = T, col_types = "cicccnnc")
result_df <- get_snp_ids(combine_gwas_df, ref_df )
View(result_df)
result_df <- get_snp_ids(combine_gwas_df, ref_df, out_file_path = "~/code/personal/genewiseR_data/tmp.tsv" )
result_df <- get_snp_ids(combine_gwas_df, ref_df )
devtools::build()
debugSource('~/code/personal/genewiseR/R/get-snp-ids.r')
result_df <- get_snp_ids(combine_gwas_df, ref_df, out_file_path = "~/code/personal/genewiseR_data/tmp.tsv" )
library(futile.logger)
result_df <- get_snp_ids(combine_gwas_df, ref_df, out_file_path = "~/code/personal/genewiseR_data/tmp.tsv" )
library(futile.logger)
devtools::build()
library(assertthat)
flog.debug(paste0("Missing ids replaced with custom names", length_missing_ids, custom_names[0]))
flog.info(paste0("Missing ids replaced with custom names", length_missing_ids, custom_names[0]))
flog.threshold()
flog.threshold(DEBUG)
flog.threshold()
flog.debug(paste0("Missing ids replaced with custom names", length_missing_ids, custom_names[0]))
library(readr)
library(genewiseR)
source('~/code/personal/genewiseR/R/generate_new_snp_ids.R')
df <- read_csv("../genewiseR_data/tmp.tsv")
ref_df <- read_tsv("~/code/personal/genewiseR_data/ref/indels.Bos_taurus.vcf", comment = "##", progress = T, trim_ws = T, col_types = "cicccnnc")
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = F,col_names = c("chr","pos","allele","p_value"))
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR_data/raw_data/",header = F,col_names = c("chr","pos","allele","p_value"))
result_df <- get_snp_ids(combine_gwas_df, ref_df, out_file_path = "~/code/personal/genewiseR_data/tmp.tsv" )
with_ids_dt <- generate_new_snp_ids(result_df)
result_df[,!nzchar("snp_pos")]
result_df[,!nzchar(snp_pos)]
source('~/code/personal/genewiseR/R/generate_new_snp_ids.R')
with_ids_dt <- generate_new_snp_ids(result_df)
names(result_df)
source('~/code/personal/genewiseR/R/generate_new_snp_ids.R')
with_ids_dt <- generate_new_snp_ids(result_df)
result_df <- as.data.table(result_df)
result_df[,!nzchar(snp_id)]
sum(result_df[,!nzchar(snp_id)])
is.na(result_df$snp_id)
result_df[is.na(snp_id)]
source('~/code/personal/genewiseR/R/generate_new_snp_ids.R')
with_ids_dt <- generate_new_snp_ids(result_df)
q
sdfa
source('~/code/personal/genewiseR/R/generate_new_snp_ids.R')
with_ids_dt <- generate_new_snp_ids(result_df)
source('~/code/personal/genewiseR/R/generate_new_snp_ids.R')
with_ids_dt <- generate_new_snp_ids(result_df)
result_df <- get_snp_ids(combine_gwas_df, ref_df, out_file_path = "~/code/personal/genewiseR_data/tmp.tsv" )
with_ids_dt <- generate_new_snp_ids(result_df)
source('~/code/personal/genewiseR/R/generate_new_snp_ids.R')
result_df <- get_snp_ids(combine_gwas_df, ref_df, out_file_path = "~/code/personal/genewiseR_data/tmp.tsv" )
with_ids_dt <- generate_new_snp_ids(result_df)
source('~/code/personal/genewiseR/R/generate_new_snp_ids.R')
result_df <- get_snp_ids(combine_gwas_df, ref_df, out_file_path = "~/code/personal/genewiseR_data/tmp.tsv" )
with_ids_dt <- generate_new_snp_ids(result_df)
source('~/code/personal/genewiseR/R/generate_new_snp_ids.R')
result_df <- get_snp_ids(combine_gwas_df, ref_df, out_file_path = "~/code/personal/genewiseR_data/tmp.tsv" )
with_ids_dt <- generate_new_snp_ids(result_df)
savehistory(file="./.Rhistory")
library(readr)
study_df <- read_csv("../genewiseR_data/tmp.tsv")
combine_gwas_df <- dir_rbind("../genewiseR_data/raw_data/", header = F,col_names = c("chr","pos","allele","p_value"))
library(genewiseR)
combine_gwas_df <- dir_rbind("../genewiseR_data/raw_data/", header = F,col_names = c("chr","pos","allele","p_value"))
ref_df <- read_tsv("../genewiseR_data/ref/indels.Bos_taurus.vcf", comment = "##", progress = T, trim_ws = T, col_types = "cicccnnc")
result_df <- get_snp_ids(combine_gwas_df, ref_df, out_file_path = "../genewiseR_data/tmp.tsv" )
View(result_df)
source('~/code/personal/genewiseR/R/multiple-correction.r')
p_adjustment(study_df = result_df, col_names = "p_value", level = "genome", test = "fdr")
source('~/code/personal/genewiseR/R/multiple-correction.r')
p_adjustment(study_df = result_df, col_names = "p_value", level = "genome", test = "fdr")
library(testthat)
library(assertthat
)
p_adjustment(study_df = result_df, col_names = "p_value", level = "genome", test = "fdr")
library(futile.logger)
p_adjustment(study_df = result_df, col_names = "p_value", level = "genome", test = "fdr")
source('~/code/personal/genewiseR/R/multiple-correction.r')
p_adjustment(study_df = result_df, col_names = "p_value", level = "genome", test = "fdr")
View(result_df)
qplot(p_value_adj_genome_wide)
library(ggplot2)
qplot(p_value_adj_genome_wide)
qplot(result_df$p_value_adj_genome_wide)
p_adjustment(study_df = result_df, col_names = "p_value", level = "genome", test = "bonferroni")
qplot(result_df$p_value_adj_genome_wide)
p_adjustment(study_df = result_df, col_names = "p_value", level = "genome", test = "hommel")
library(genewiseR)
library(readr)
t <- read_csv("../genewiseR_data/tmp.tsv")
View(t)
t <- read_tsv("../genewiseR_data/tmp.tsv")
p_adjustment(study_df = result_df, col_names = "p_value", level = "genome", test = "hommel")
library(devtools)
devtools::install_local(".")
devtools::install_local("~/code/personal/genewiseR/")
p_adjustment(study_df = result_df, col_names = "p_value", level = "genome", test = "hommel")
p_adjustment(study_df = t, col_names = "p_value", level = "genome", test = "hommel")
library(testthat)
library(assertthat)
p_adjustment(study_df = t, col_names = "p_value", level = "genome", test = "hommel")
p_adjustment(study_df = t, col_names = "p_value", level = "genome", test = "fdr")
View(t)
names(t)
install.packages("devtools")
devtools::install_github("twitter/AnomalyDetection")
library(AnomalyDetection)
install.packages("devtools")
library(futile.logger)
library(testthat)
library(assertthat)
devtools::install_local("~/code/personal/genewiseR/")
library(genewiseR)
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR/data/",header = F,col_names = c("chr","pos","allele","p_value"))
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR_data/raw_data/",header = F,col_names = c("chr","pos","allele","p_value"))
ref_df <- read_tsv("~/code/personal/genewiseR_data/ref/indels.Bos_taurus.vcf", comment = "##", progress = T, trim_ws = T, col_types = "cicccnnc")
library(readr)
ref_df <- read_tsv("~/code/personal/genewiseR_data/ref/indels.Bos_taurus.vcf", comment = "##", progress = T, trim_ws = T, col_types = "cicccnnc")
result_df <- get_snp_ids(combine_gwas_df, ref_df, out_file_path = "~/code/personal/genewiseR_data/tmp.tsv" )
result_df <- get_snp_ids(combine_gwas_df, ref_df)
with_ids_dt <- generate_new_snp_ids(result_df)
savehistory(".genewiseRHistory")
p_adjustment(study_df = with_ids_dt, col_names = "p_value", level = "genome", test = "fdr")
View(with_ids_dt)
write_tsv(with_ids_dt, "~/code/personal/genewiseR_data/p_genome_wide.tsv")
p_adjustment(study_df = with_ids_dt, col_names = "p_value", level = "genome", test = "fdr")
View(with_ids_dt)
source('~/code/personal/genewiseR/R/multiple-correction.r')
View(with_ids_dt)
p_adjustment(study_df = with_ids_dt, col_names = "p_value", level = "genome", test = "fdr")
source('~/code/personal/genewiseR/R/multiple-correction.r')
p_adjustment(study_df = with_ids_dt, col_names = "p_value", level = "genome", test = "fdr")
futflog.threshold(DEBUG)
flog.threshold(DEBUG)
source('~/code/personal/genewiseR/R/multiple-correction.r')
p_adjustment(study_df = with_ids_dt, col_names = "p_value", level = "genome", test = "fdr")
source('~/code/personal/genewiseR/R/multiple-correction.r')
p_adjustment(study_df = with_ids_dt, col_names = "p_value", level = "genome", test = "fdr")
source('~/code/personal/genewiseR/R/multiple-correction.r')
combine_gwas_df <- dir_rbind("/Users/nehiljain/code/personal/genewiseR_data/raw_data/",header = F,col_names = c("chr","pos","allele","p_value"))
with_ids_dt <- generate_new_snp_ids(result_df)
ref_df <- read_tsv("~/code/personal/genewiseR_data/ref/indels.Bos_taurus.vcf", comment = "##", progress = T, trim_ws = T, col_types = "cicccnnc")
result_df <- get_snp_ids(combine_gwas_df, ref_df, out_file_path = "~/code/personal/genewiseR_data/tmp.tsv" )
result_df <- get_snp_ids(combine_gwas_df, ref_df)
with_ids_dt <- generate_new_snp_ids(result_df)
p_adjustment(study_df = with_ids_dt, col_names = "p_value", level = "genome", test = "fdr")
View(with_ids_dt)
p_adjustment(study_df = with_ids_dt, col_names = "p_value", level = "genome", test = "bon")
View(with_ids_dt)
p_adjustment(study_df = with_ids_dt, col_names = "p_value", level = "genome", test = "BH")
View(with_ids_dt)
str(with_ids_dt)
p_adjustment(study_df = with_ids_dt, col_names = "p_value", level = "chromosomewide", test = "BH")
p_adjustment(study_df = with_ids_dt, col_names = "p_value", level = "chromosome", test = "BH")
p_adjustment(study_df = with_ids_dt, col_names = "p_value", level = "chromosome", test = "fdr")
str(with_ids_dt)
savehistory(".genewiseRHistory")
